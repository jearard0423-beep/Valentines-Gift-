:root{
  --bg:#f6e8f2;
  --accent:#d6336c;
  --box:#ff9bb3;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,Helvetica,sans-serif;background:linear-gradient(180deg,rgba(246,232,242,0.85),rgba(255,255,255,0.85)),url('https://media.giphy.com/media/jiVsld6wK2ay1Z8ZrG/giphy.gif');background-size:cover;background-position:center;background-attachment:fixed;background-blend-mode:overlay}
.stage{height:100vh;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;perspective:1200px}
.gift-wrap{transform-style:preserve-3d}
.gift-box{width:320px;height:220px;position:relative;cursor:pointer;transform-style:preserve-3d;transition:transform .7s cubic-bezier(.2,.9,.3,1);transform:translateZ(0)}
.gift-box .box{width:100%;height:100%;background:linear-gradient(180deg,var(--box),#ff6b97);border-radius:12px;box-shadow:0 30px 60px rgba(0,0,0,.2);position:relative;transform:translateZ(8px)}
.gift-box .lid{position:absolute;top:-50px;left:10px;right:10px;height:100px;background:linear-gradient(180deg,#fff,#ffd2df);border-radius:16px;transform-origin:50% 100%;transform:rotateX(0deg) translateZ(30px);transition:transform .9s cubic-bezier(.2,.9,.3,1);box-shadow:0 12px 26px rgba(0,0,0,.18)}
.gift-box.open .lid{transform:rotateX(-110deg) translateZ(40px);}
.gift-box:active{transform:scale(.98) rotateX(4deg)}

/* ribbon */
.ribbon{position:absolute;background:linear-gradient(90deg,var(--accent),#ff145f);box-shadow:0 6px 14px rgba(0,0,0,.12);}
.ribbon.horizontal{height:26px;left:0;right:0;top:105px;border-radius:6px}
.ribbon.vertical{width:26px;top:0;bottom:0;left:145px;margin:auto;border-radius:6px}

/* subtle top bow */
.gift-box::after{content:"";position:absolute;left:50%;top:54px;width:48px;height:26px;background:linear-gradient(90deg,#fff1,#ff7aa0);transform:translateX(-50%) translateZ(44px);border-radius:6px;box-shadow:0 6px 12px rgba(0,0,0,.12)}

.gift-box.open{transform:translateY(-14px) rotateX(4deg)}

/* bow SVG styling */
.bow-svg{position:absolute;left:50%;top:28px;transform:translateX(-50%) translateZ(54px);pointer-events:none;filter:drop-shadow(0 6px 12px rgba(0,0,0,.12));transition:transform .8s cubic-bezier(.2,.9,.3,1),opacity .4s}
.gift-box.open .bow-svg{transform:translateX(-50%) translateY(-8px) rotateX(8deg) scale(1.02) translateZ(64px)}
.bow-left,.bow-right{transform-origin:40px 28px;transition:transform .9s cubic-bezier(.2,.9,.3,1)}
.gift-box.open .bow-left{transform:translateX(-6px) rotate(-18deg)}
.gift-box.open .bow-right{transform:translateX(6px) rotate(18deg)}
.bow-knot{transition:transform .6s ease}
.gift-box.open .bow-knot{transform:scale(1.03)}


.content{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100%;max-width:100%;padding:0 clamp(10px,3vw,20px);background:transparent;display:flex;flex-direction:column;gap:0;align-items:center;justify-content:center;overflow:visible;min-height:100%}
.content.hidden{opacity:0;pointer-events:none;transform:translate(-50%,-48%);transition:all .6s ease}
.content.visible{opacity:1;pointer-events:auto;transform:translate(-50%,-50%);}

/* Two-column wrapper - responsive scaling */
.content-wrapper{display:flex;flex-direction:column;gap:clamp(20px,5vw,60px);align-items:center;justify-content:center;width:100%;padding:0 clamp(10px,3vw,30px);max-width:100%;margin:0 auto}


.letter-container{width:min(90vw,350px);flex:0 0 auto;position:relative;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;background:linear-gradient(135deg,#ffd9e8 0%,#ffe6f0 100%);border:3px solid #6b4953;border-radius:0px;box-shadow:0 20px 50px rgba(0,0,0,0.15);padding:clamp(35px,5vw,50px) clamp(18px,4vw,28px) clamp(35px,5vw,50px) clamp(18px,4vw,28px);min-height:auto;margin:0 auto;overflow:hidden}

/* Top flap effect */
.letter-container::before{content:'';position:absolute;top:0;left:0;right:0;height:35px;background:linear-gradient(135deg,#ffb3d0 0%,#ffc9db 100%);border:3px solid #6b4953;border-bottom:2px dashed #6b4953;box-shadow:inset 0 2px 8px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.15);z-index:5}

/* Center divider line - fold down the middle */
.letter-container::after{content:'';position:absolute;left:50%;top:35px;bottom:0;width:2px;background:repeating-linear-gradient(180deg,#6b4953 0px,#6b4953 5px,transparent 5px,transparent 10px);opacity:0.4;z-index:4}


.letter-content{display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:10;position:relative;width:100%;height:auto;padding:0;box-sizing:border-box;overflow:visible;text-align:center}


.letter-title{margin:0 0 clamp(12px,3vw,20px) 0;font-size:clamp(16px,4vw,24px);color:#d6336c;font-weight:900;position:relative;top:auto;left:auto}
.letter-body{color:#6b4953;font-size:clamp(11px,2.5vw,14px);line-height:1.4;max-height:none;overflow:hidden;display:block;margin:0;padding:0;word-wrap:break-word;word-break:break-word}
.letter-body p{margin:clamp(8px,2vw,12px) 0}
.signature{margin:clamp(12px,2.5vw,16px) 0 0 0;font-size:clamp(10px,2vw,12px);font-weight:600}


.yes-btn{margin:clamp(16px,4vw,24px) 0 0 0;padding:clamp(10px,2.5vw,14px) clamp(24px,5vw,40px);background:linear-gradient(90deg,#ff6b97,#ff335f);border:none;color:white;font-weight:700;border-radius:24px;cursor:pointer;font-size:clamp(13px,3vw,16px);transition:transform .3s ease,box-shadow .3s ease;box-shadow:0 6px 16px rgba(255,51,95,0.3);z-index:10;position:relative}
.yes-btn:hover{transform:scale(1.1);box-shadow:0 8px 20px rgba(255,51,95,0.4)}
.yes-btn:active{transform:scale(0.95)}

/* Bird formation layout - heart shape on right side */
.bird-formation{display:grid;grid-template-columns:repeat(9,1fr);grid-template-rows:repeat(9,1fr);position:relative;width:min(90vw,320px);height:min(90vw,320px);gap:8px;perspective:1000px;align-items:center;justify-items:center;padding:0;margin:0 auto;top:auto;left:auto;right:auto}

/* Cross pattern positioning */
.bird-item{width:min(55px,12vw);height:min(55px,12vw);position:relative;box-shadow:0 10px 25px rgba(0,0,0,.15);opacity:0;transform:translateY(50px) scale(0.3);will-change:transform,opacity;clip-path:url(#heartClip);cursor:pointer}

/* Heart formation - arranging 5 pictures in a heart shape */
.bird-item:nth-child(1){grid-column:5;grid-row:2;z-index:5;animation-delay:0ms}
.bird-item:nth-child(2){grid-column:2;grid-row:5;z-index:4;animation-delay:100ms}
.bird-item:nth-child(3){grid-column:8;grid-row:5;z-index:3;animation-delay:200ms}
.bird-item:nth-child(4){grid-column:3;grid-row:8;z-index:2;animation-delay:300ms}
.bird-item:nth-child(5){grid-column:7;grid-row:8;z-index:1;animation-delay:400ms}

.bird-item img{width:100%;height:100%;object-fit:cover;display:block}


/* Letter slide-in animation */
@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-100px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.letter-container.slide-in {
  animation: slideInLeft 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.bird-formation.slide-in-right {
  animation: slideInRight 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes birdPop {
  0% {
    opacity: 0;
    transform: scale(0.2) translateY(60px);
  }
  60% {
    opacity: 1;
    transform: scale(1.15);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.bird-item.show{animation:birdPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards}

/* Petal burst animation */
@keyframes petalBurst {
  0% {
    opacity: 1;
    transform: translate(0, 0) scale(1) rotate(0deg);
  }
  100% {
    opacity: 0;
    transform: translate(var(--tx), var(--ty)) scale(0.3) rotate(360deg);
  }
}

.petal {
  position: fixed;
  width: clamp(20px, 5vw, 40px);
  height: clamp(20px, 5vw, 40px);
  pointer-events: none;
  border-radius: 50% 0 50% 50%;
  will-change: transform, opacity;
  z-index: 999;
}

/* GIF embed container */
.gif-container{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(0);z-index:1000;background:white;border-radius:16px;padding:20px;box-shadow:0 30px 80px rgba(0,0,0,.25);max-width:480px;width:90%;opacity:0;pointer-events:none;transition:opacity .4s ease,transform .5s cubic-bezier(0.34, 1.56, 0.64, 1)}
.gif-container.visible{opacity:1;pointer-events:auto;transform:translate(-50%,-50%) scale(1)}
.gif-container.hidden{display:none}
.tenor-gif-embed{width:100%;border-radius:12px;overflow:hidden}

.trail-layer{position:fixed;inset:0;pointer-events:none}
.trail-item{position:fixed;width:48px;height:48px;border-radius:8px;overflow:hidden;pointer-events:none;will-change:transform,opacity;transform-origin:center}

/* Heart stage and bird-formation styles */
.heart-stage{width:280px;height:200px;flex:0 0 200px;position:relative;border-radius:18px;display:block;margin:0}
.heart-stage .heart-bg{position:absolute;inset:0;background:radial-gradient(circle at 35% 30%, #fff4f6, transparent 40%), linear-gradient(180deg,#ffeef3,#ffdde8);border-radius:18px;filter:drop-shadow(0 12px 30px rgba(214,51,108,0.08));}

/* music control */
.music-control{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;background:rgba(255,255,255,0.85);box-shadow:0 8px 20px rgba(0,0,0,.08);font-size:12px}
.music-btn{display:none;background:linear-gradient(90deg,#ff6b97,#ff335f);border:none;color:white;padding:5px 10px;border-radius:8px;cursor:pointer;font-weight:600;font-size:11px}
.music-btn:active{transform:scale(.98)}
.music-label{font-size:11px;color:#6b4953;max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.trail-item img{width:100%;height:100%;object-fit:cover}

/* Tablet small (600-899px) - column layout */
@media (min-width:600px) and (max-width:899px){
  .stage{min-height:100vh;padding:20px 0;display:flex;align-items:center}
  .content{width:100%;max-width:100%;position:relative;top:auto;left:auto;transform:none}
  .content-wrapper{flex-direction:column;gap:clamp(25px,5vw,40px);padding:0 clamp(12px,3vw,25px);margin:0 auto}
  .letter-container{width:min(90vw,420px);padding:clamp(40px,5vw,50px) clamp(20px,4vw,30px);margin:0 auto}
  .letter-title{font-size:clamp(15px,3.5vw,18px)}
  .letter-body{font-size:clamp(11px,2.2vw,13px)}
  .letter-body p{margin:clamp(6px,1.5vw,10px) 0}
  .yes-btn{font-size:clamp(12px,2.5vw,14px);margin-top:clamp(12px,3vw,16px)}
  .bird-formation{width:min(80vw,400px);height:min(80vw,400px);gap:9px;margin:0 auto}
  .bird-item{width:min(65px,11vw);height:min(65px,11vw)}
}

/* iPad/Tablet large (900-1199px) - column layout */
@media (min-width:900px) and (max-width:1199px){
  .stage{min-height:100vh;padding:30px 0;display:flex;align-items:center}
  .content{width:100%;max-width:100%;position:relative;top:auto;left:auto;transform:none}
  .content-wrapper{flex-direction:column;gap:clamp(30px,5vw,50px);padding:0 clamp(15px,3vw,30px);margin:0 auto}
  .letter-container{width:min(85vw,480px);padding:clamp(40px,5vw,50px) clamp(20px,4vw,35px);margin:0 auto}
  .letter-title{font-size:clamp(16px,3vw,18px)}
  .letter-body{font-size:clamp(11px,2vw,13px)}
  .letter-body p{margin:clamp(6px,1.5vw,10px) 0}
  .yes-btn{font-size:clamp(12px,2.3vw,14px);margin-top:clamp(12px,3vw,16px)}
  .bird-formation{width:min(80vw,450px);height:min(80vw,450px);gap:10px;margin:0 auto}
  .bird-item{width:min(70px,11vw);height:min(70px,11vw)}
}

/* Desktop (1200px-1439px) - row layout */
@media (min-width:1200px) and (max-width:1439px){
  .stage{min-height:100vh;padding:40px 20px}
  .content{width:100%;max-width:100%;top:auto;left:auto;transform:none}
  .content-wrapper{flex-direction:row;gap:clamp(40px,6vw,80px);padding:40px clamp(20px,4vw,40px);margin:0 auto;align-items:flex-start;justify-content:center;max-width:1400px}
  .letter-container{width:min(45vw,480px);padding:clamp(40px,4vw,50px) clamp(20px,3vw,35px);flex-shrink:0}
  .letter-title{font-size:clamp(16px,2.5vw,20px)}
  .letter-body{font-size:clamp(11px,1.8vw,13px)}
  .letter-body p{margin:clamp(6px,1.2vw,10px) 0}
  .yes-btn{font-size:clamp(12px,2vw,14px);margin-top:clamp(12px,2vw,16px)}
  .bird-formation{width:min(45vw,500px);height:min(45vw,500px);gap:11px;flex-shrink:0}
  .bird-item{width:min(80px,12vw);height:min(80px,12vw)}
}

/* Large Desktop (1440px+) - expanded row layout */
@media (min-width:1440px){
  .stage{padding:40px 20px;min-height:100vh}
  .content{width:100%;max-width:100%;top:auto;left:auto;transform:none}
  .content-wrapper{flex-direction:row;gap:clamp(60px,8vw,140px);padding:40px clamp(30px,5vw,60px);margin:0 auto;align-items:flex-start;justify-content:center;max-width:1600px}
  .letter-container{width:520px;padding:50px 35px;flex-shrink:0}
  .letter-title{font-size:24px}
  .letter-body{font-size:14px}
  .letter-body p{margin:10px 0}
  .yes-btn{font-size:16px;margin-top:20px}
  .bird-formation{width:560px;height:560px;gap:14px;flex-shrink:0}
  .bird-item{width:150px;height:150px}
}
