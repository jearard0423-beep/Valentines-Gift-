:root{
  --bg:#f6e8f2;
  --accent:#d6336c;
  --box:#ff9bb3;
  /* bird formation nudge offsets (change to reposition whole formation) */
  --bird-offset-x: 0px;
  --bird-offset-y: 0px;
}
/* Prevent any accidental horizontal scrolling caused by large artwork or elements */
html,body{overflow-x:hidden}
*{box-sizing:border-box}
html,body{width:100%;height:100%;margin:0;padding:0;font-family:Inter,system-ui,Arial,Helvetica,sans-serif;background:linear-gradient(180deg,rgba(246,232,242,0.85),rgba(255,255,255,0.85)),url('https://media.giphy.com/media/jiVsld6wK2ay1Z8ZrG/giphy.gif');background-size:cover;background-position:center;background-attachment:fixed;background-blend-mode:overlay;overflow:hidden;scrollbar-width:none;-ms-overflow-style:none;overflow-x:hidden}
html::-webkit-scrollbar,body::-webkit-scrollbar{display:none}
.stage{width:100%;height:100vh;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;perspective:1200px;margin:0;padding:0}
.gift-wrap{transform-style:preserve-3d}
.gift-box{width:320px;height:220px;position:relative;cursor:pointer;transform-style:preserve-3d;transition:transform .7s cubic-bezier(.2,.9,.3,1);transform:translateZ(0)}
.gift-box .box{width:100%;height:100%;background:linear-gradient(180deg,var(--box),#ff6b97);border-radius:12px;box-shadow:0 30px 60px rgba(0,0,0,.2);position:relative;transform:translateZ(8px)}
.gift-box .lid{position:absolute;top:-50px;left:10px;right:10px;height:100px;background:linear-gradient(180deg,#fff,#ffd2df);border-radius:16px;transform-origin:50% 100%;transform:rotateX(0deg) translateZ(30px);transition:transform .9s cubic-bezier(.2,.9,.3,1);box-shadow:0 12px 26px rgba(0,0,0,.18)}
.gift-box.open .lid{transform:rotateX(-110deg) translateZ(40px);}
.gift-box:active{transform:scale(.98) rotateX(4deg)}

/* ribbon */
.ribbon{position:absolute;background:linear-gradient(90deg,var(--accent),#ff145f);box-shadow:0 6px 14px rgba(0,0,0,.12);}
.ribbon.horizontal{height:26px;left:0;right:0;top:105px;border-radius:6px}
.ribbon.vertical{width:26px;top:0;bottom:0;left:145px;margin:auto;border-radius:6px}

/* subtle top bow */
.gift-box::after{content:"";position:absolute;left:50%;top:54px;width:48px;height:26px;background:linear-gradient(90deg,#fff1,#ff7aa0);transform:translateX(-50%) translateZ(44px);border-radius:6px;box-shadow:0 6px 12px rgba(0,0,0,.12)}

.gift-box.open{transform:translateY(-14px) rotateX(4deg)}

/* bow SVG styling */
.bow-svg{position:absolute;left:50%;top:28px;transform:translateX(-50%) translateZ(54px);pointer-events:none;filter:drop-shadow(0 6px 12px rgba(0,0,0,.12));transition:transform .8s cubic-bezier(.2,.9,.3,1),opacity .4s}
.gift-box.open .bow-svg{transform:translateX(-50%) translateY(-8px) rotateX(8deg) scale(1.02) translateZ(64px)}
.bow-left,.bow-right{transform-origin:40px 28px;transition:transform .9s cubic-bezier(.2,.9,.3,1)}
.gift-box.open .bow-left{transform:translateX(-6px) rotate(-18deg)}
.gift-box.open .bow-right{transform:translateX(6px) rotate(18deg)}
.bow-knot{transition:transform .6s ease}
.gift-box.open .bow-knot{transform:scale(1.03)}


.content{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:100%;
  max-width:100%;
  padding:0 clamp(10px,3vw,20px);
  background:transparent;
  display:flex;
  flex-direction:column;
  gap:0;
  align-items:center;
  justify-content:center;
  overflow:auto;
  min-height:auto;
  max-height:100vh;
  scrollbar-width:none;
  -ms-overflow-style:none;
}

.content::-webkit-scrollbar{
  display:none;
}

.content.hidden{
  opacity:0;
  pointer-events:none;
  transform:translate(-50%,-48%);
  transition:all .6s ease;
}

.content.visible{
  position:fixed !important;
  left:50% !important;
  top:50% !important;
  transform:translate(-50%,-50%) !important;
  width:calc(100vw - 40px) !important;
  max-width:calc(100vw - 40px) !important;
  max-height:calc(100vh - 40px) !important;
  z-index:1200 !important;
  padding:0 !important;
  overflow:hidden !important;
  display:flex !important;
  align-items:center !important;
  justify-content:center !important;
  opacity: 1 !important;
  pointer-events: auto !important;
  scrollbar-width:none !important;
  -ms-overflow-style:none !important;
}

.content.visible::-webkit-scrollbar{
  display:none !important;
}
.letter-container {
  max-height:none;
  overflow:visible;
  margin:0 auto;
}

@media (max-width:420px){
  .stage{padding:0;height:100vh;overflow:hidden}
  .gift-box{width:280px;height:190px}
  .content.visible{max-height:100vh !important;overflow:hidden !important;display:flex !important;padding:0 !important}
  .content-wrapper{flex-direction:column;gap:clamp(8px,1.4vw,10px);padding:clamp(8px,1.6vw,10px) clamp(6px,1.5vw,10px);width:100%;max-width:100%;align-items:center;justify-content:flex-start;flex:1;overflow:hidden}
  .letter-container{width:min(88vw,310px);padding:clamp(12px,2.4vw,15px) clamp(10px,2.2vw,14px);margin:0 auto;flex-shrink:0;min-height:auto;overflow:visible}
  .letter-container::before{height:clamp(20px,3.8vw,26px)}
  .letter-container::after{top:clamp(20px,3.8vw,26px)}
  .letter-title{font-size:clamp(13px,3.2vw,16px);margin:0 0 clamp(4px,0.9vw,6px) 0;display:block;visibility:visible;font-weight:900}
  .letter-body{font-size:clamp(9px,1.8vw,10px);line-height:1.15;margin:0}
  .letter-body p{margin:clamp(2px,0.5vw,3px) 0;display:block}
  .signature{font-size:clamp(8px,1.5vw,9px);margin:clamp(3px,0.6vw,4px) 0 0 0}
  .yes-btn{padding:clamp(5px,1.2vw,7px) clamp(14px,2.8vw,20px);font-size:clamp(9px,1.8vw,11px);margin:clamp(6px,1.2vw,8px) 0 0 0}
  .bird-formation{width:min(65vw,200px);height:min(65vw,200px);gap:1px;padding:0;margin:clamp(8px,1.5vw,10px) auto 0 auto;flex-shrink:0;position:relative}
  .bird-item{width:min(20vw,48px);height:min(20vw,48px)}
}

/* Two-column wrapper - responsive scaling */
.content-wrapper{display:flex;flex-direction:column;gap:clamp(15px,4vw,50px);align-items:center;justify-content:center;width:100%;max-width:100%;padding:clamp(15px,2.5vw,30px) clamp(10px,2vw,25px);margin:0 auto;max-height:calc(100vh - 40px);overflow:hidden}


.letter-container{width:min(90vw,350px);flex:0 0 auto;position:relative;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;background:linear-gradient(135deg,#ffd9e8 0%,#ffe6f0 100%);border:3px solid #6b4953;border-radius:0px;box-shadow:0 20px 50px rgba(0,0,0,0.15);padding:clamp(16px,3.5vw,50px) clamp(14px,3vw,28px);min-height:auto;margin:0 auto;overflow:visible}

/* Top flap effect */
.letter-container::before{content:'';position:absolute;top:0;left:0;right:0;height:35px;background:linear-gradient(135deg,#ffb3d0 0%,#ffc9db 100%);border:3px solid #6b4953;border-bottom:2px dashed #6b4953;box-shadow:inset 0 2px 8px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.15);z-index:5}

/* Center divider line - removed for cleaner look */
.letter-container::after{content:'';display:none;}


.letter-content{display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:10;position:relative;width:100%;height:auto;padding:0;box-sizing:border-box;overflow:visible;text-align:center}


.letter-title{margin:0 0 clamp(12px,2.8vw,18px) 0;font-size:clamp(14px,3.8vw,24px);color:#d6336c;font-weight:900;position:relative;top:auto;left:auto;visibility:visible;display:block}
.letter-body{color:#6b4953;font-size:clamp(11px,2.5vw,14px);line-height:1.35;max-height:none;overflow:hidden;display:block;margin:0;padding:0;word-wrap:break-word;word-break:break-word}
.letter-body p{margin:clamp(6px,1.5vw,10px) 0}
.signature{margin:clamp(8px,2vw,14px) 0 0 0;font-size:clamp(9px,1.8vw,11px);font-weight:600}


.yes-btn{margin:clamp(12px,3vw,20px) 0 0 0;padding:clamp(8px,2vw,14px) clamp(20px,4vw,40px);background:linear-gradient(90deg,#ff6b97,#ff335f);border:none;color:white;font-weight:700;border-radius:24px;cursor:pointer;font-size:clamp(13px,3vw,16px);transition:transform .3s ease,box-shadow .3s ease;box-shadow:0 6px 16px rgba(255,51,95,0.3);z-index:10;position:relative}
.yes-btn:hover{transform:scale(1.1);box-shadow:0 8px 20px rgba(255,51,95,0.4)}
.yes-btn:active{transform:scale(0.95)}

/* Bird formation layout - heart shape on right side */
.bird-formation{position:relative;display:block;width:min(86vw,420px);height:min(86vw,420px);perspective:1000px;padding:0;margin:0 auto}

/* Cross pattern positioning */
.bird-item{position:absolute;width:min(18%,140px);height:min(18%,140px);box-shadow:0 10px 25px rgba(0,0,0,.15);opacity:0;transform:translateY(40px) scale(0.3);will-change:transform,opacity;clip-path:url(#heartClip);cursor:pointer;border-radius:10px;overflow:hidden}

/* Heart formation - arranging 5 pictures in a heart shape */
.bird-item:nth-child(1){left:50%;top:12%;transform:translate(-50%,-50%) scale(0.3);z-index:6;animation-delay:0ms}
.bird-item:nth-child(2){left:25%;top:35%;transform:translate(-50%,-50%) scale(0.3);z-index:5;animation-delay:100ms}
.bird-item:nth-child(3){left:75%;top:35%;transform:translate(-50%,-50%) scale(0.3);z-index:4;animation-delay:200ms}
.bird-item:nth-child(4){left:35%;top:70%;transform:translate(-50%,-50%) scale(0.3);z-index:3;animation-delay:300ms}
.bird-item:nth-child(5){left:65%;top:70%;transform:translate(-50%,-50%) scale(0.3);z-index:2;animation-delay:400ms}

.bird-item img{width:100%;height:100%;object-fit:cover;display:block}


/* Letter slide-in animation */
@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-100px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.letter-container.slide-in {
  animation: slideInLeft 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.bird-formation.slide-in-right {
  animation: slideInRight 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes birdPop {
  0% {
    opacity: 0;
    transform: scale(0.2) translateY(60px);
  }
  60% {
    opacity: 1;
    transform: scale(1.15);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.bird-item.show{animation:birdPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards}

/* Petal burst animation */
@keyframes petalBurst {
  0% {
    opacity: 1;
    transform: translate(0, 0) scale(1) rotate(0deg);
  }
  100% {
    opacity: 0;
    transform: translate(var(--tx), var(--ty)) scale(0.3) rotate(360deg);
  }
}

.petal {
  position: fixed;
  width: clamp(20px, 5vw, 40px);
  height: clamp(20px, 5vw, 40px);
  pointer-events: none;
  border-radius: 50% 0 50% 50%;
  will-change: transform, opacity;
  z-index: 999;
}

/* GIF embed container */
.gif-container{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(0);z-index:1000;background:white;border-radius:16px;padding:20px;box-shadow:0 30px 80px rgba(0,0,0,.25);max-width:480px;width:90%;opacity:0;pointer-events:none;transition:opacity .4s ease,transform .5s cubic-bezier(0.34, 1.56, 0.64, 1)}
.gif-container.visible{opacity:1;pointer-events:auto;transform:translate(-50%,-50%) scale(1)}
/* Keep hidden state interactive-free but allow transitions instead of forcing display:none.
  This prevents the element from being abruptly removed which could cause flicker/vanish on some devices. */
.gif-container.hidden{opacity:0;pointer-events:none;transform:translate(-50%,-50%) scale(0)}
.tenor-gif-embed{width:100%;border-radius:12px;overflow:hidden}

.trail-layer{position:fixed;inset:0;pointer-events:none}
.trail-item{position:fixed;width:48px;height:48px;border-radius:8px;overflow:hidden;pointer-events:none;will-change:transform,opacity;transform-origin:center}

/* Heart stage and bird-formation styles */
.heart-stage{width:280px;height:200px;flex:0 0 200px;position:relative;border-radius:18px;display:block;margin:0}
.heart-stage .heart-bg{position:absolute;inset:0;background:radial-gradient(circle at 35% 30%, #fff4f6, transparent 40%), linear-gradient(180deg,#ffeef3,#ffdde8);border-radius:18px;filter:drop-shadow(0 12px 30px rgba(214,51,108,0.08));}

/* music control */
.music-control{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;background:rgba(255,255,255,0.85);box-shadow:0 8px 20px rgba(0,0,0,.08);font-size:12px}
.music-btn{display:none;background:linear-gradient(90deg,#ff6b97,#ff335f);border:none;color:white;padding:5px 10px;border-radius:8px;cursor:pointer;font-weight:600;font-size:11px}
.music-btn:active{transform:scale(.98)}
.music-label{font-size:11px;color:#6b4953;max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.trail-item img{width:100%;height:100%;object-fit:cover}

/* Tablet small (420px-599px) */
@media (min-width:420px) and (max-width:599px){
  .stage{height:100vh;padding:0}
  .gift-box{width:300px;height:205px}
  .content.visible{width:calc(100vw - 30px) !important;max-width:calc(100vw - 30px) !important;max-height:calc(100vh - 10px) !important;overflow:hidden !important;display:flex !important}
  .content-wrapper{flex-direction:column;gap:clamp(8px,2vw,12px);padding:clamp(9px,1.8vw,14px) clamp(11px,2.2vw,18px);width:100%;max-width:100%;align-items:center;justify-content:flex-start}
  .letter-container{width:min(86vw,360px);padding:clamp(12px,2.6vw,18px) clamp(12px,2.5vw,20px);margin:0 auto;flex-shrink:0;overflow:visible}
  .letter-container::before{height:clamp(24px,4.5vw,30px)}
  .letter-container::after{top:clamp(24px,4.5vw,30px)}
  .letter-title{font-size:clamp(13px,3.2vw,15px);margin:0 0 clamp(5px,1.1vw,7px) 0}
  .letter-body{font-size:clamp(10px,2.1vw,12px);line-height:1.3}
  .letter-body p{margin:clamp(4px,0.8vw,6px) 0}
  .signature{font-size:clamp(9px,1.7vw,10px)}
  .yes-btn{font-size:clamp(11px,2.1vw,13px);margin-top:clamp(8px,1.7vw,11px);padding:clamp(7px,1.6vw,9px) clamp(18px,3.5vw,26px)}
  .bird-formation{width:min(70vw,260px);height:min(70vw,260px);gap:4px;margin:clamp(10px,2vw,14px) auto 0 auto;flex-shrink:0}
  .bird-item{width:min(18vw,58px);height:min(18vw,58px)}
}

/* Tablet small (600-899px) - column layout */
@media (min-width:600px) and (max-width:899px){
  .stage{min-height:100vh;padding:20px 0;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .content.visible{width:calc(100vw - 40px) !important;max-width:calc(100vw - 40px) !important;max-height:calc(100vh - 40px) !important;overflow:hidden !important}
  .content-wrapper{flex-direction:column;gap:clamp(12px,2.8vw,18px);padding:clamp(15px,2.4vw,20px);width:100%;max-width:100%;align-items:center;justify-content:flex-start}
  .letter-container{width:min(85vw,440px);padding:clamp(20px,2.8vw,28px) clamp(14px,2.5vw,22px);margin:0 auto;flex-shrink:0;overflow:visible}
  .letter-title{font-size:clamp(14px,3.2vw,17px)}
  .letter-body{font-size:clamp(10px,1.9vw,12px);line-height:1.35}
  .letter-body p{margin:clamp(4px,0.9vw,6px) 0}
  .yes-btn{font-size:clamp(11px,2vw,13px);margin-top:clamp(8px,1.8vw,12px)}
  .bird-formation{width:min(70vw,320px);height:min(70vw,320px);gap:5px;margin:clamp(12px,2vw,15px) auto 0 auto;flex-shrink:0}
  .bird-item{width:min(60px,10vw);height:min(60px,10vw)}
}

/* iPad/Tablet large (900-1199px) - column layout */
@media (min-width:900px) and (max-width:1199px){
  .stage{min-height:100vh;padding:30px 20px;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .content.visible{width:calc(100vw - 50px) !important;max-width:calc(100vw - 50px) !important;max-height:calc(100vh - 60px) !important;overflow:hidden !important}
  .content-wrapper{flex-direction:column;gap:clamp(24px,4vw,36px);padding:clamp(20px,2.6vw,28px);width:100%;max-width:620px;align-items:center;justify-content:flex-start;margin:0 auto}
  .letter-container{width:min(80vw,480px);padding:clamp(24px,3.2vw,38px) clamp(18px,3vw,30px);margin:0 auto;flex-shrink:0;overflow:visible}
  .letter-title{font-size:clamp(16px,3.2vw,20px)}
  .letter-body{font-size:clamp(11px,2vw,13px);line-height:1.5}
  .letter-body p{margin:clamp(6px,1.4vw,10px) 0}
  .yes-btn{font-size:clamp(12px,2.2vw,15px);margin-top:clamp(10px,2.4vw,14px)}
  .bird-formation{width:min(72vw,420px);height:min(72vw,420px);gap:8px;margin:clamp(14px,2.4vw,18px) auto 0 auto;flex-shrink:0}
  .bird-item{width:min(80px,11vw);height:min(80px,11vw)}
}

/* Desktop (1200px-1439px) - row layout */
@media (min-width:1200px) and (max-width:1439px){
  .stage{height:100vh;padding:30px 25px;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .content.visible{width:calc(100vw - 60px) !important;max-width:calc(100vw - 60px) !important;overflow:hidden !important}
  .content-wrapper{flex-direction:row;gap:clamp(40px,5vw,70px);padding:30px clamp(24px,3vw,40px);width:100%;max-width:1300px;align-items:center;justify-content:center;margin:0 auto}
  .letter-container{width:min(40vw,460px);padding:clamp(36px,3.5vw,46px) clamp(20px,3vw,34px);flex-shrink:0;margin:0}
  .letter-title{font-size:clamp(16px,2.6vw,20px)}
  .letter-body{font-size:clamp(11px,1.9vw,13px);line-height:1.5}
  .letter-body p{margin:clamp(6px,1vw,10px) 0}
  .yes-btn{font-size:clamp(12px,2vw,15px);margin-top:clamp(10px,1.8vw,16px)}
  .bird-formation{width:min(36vw,420px);height:min(36vw,420px);gap:9px;flex-shrink:0;margin:0 auto;flex-basis:auto}
  .bird-item{width:min(85px,12vw);height:min(85px,12vw)}
}

/* Large Desktop (1440px+) - expanded row layout */
@media (min-width:1440px){
  .stage{height:100vh;padding:35px 50px;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .content.visible{width:calc(100vw - 80px) !important;max-width:calc(100vw - 80px) !important;overflow:hidden !important}
  .content-wrapper{flex-direction:row;gap:clamp(60px,8vw,120px);padding:40px clamp(35px,5vw,70px);width:100%;max-width:1600px;align-items:center;justify-content:center;margin:0 auto}
  .letter-container{width:520px;padding:48px 38px;flex-shrink:0;margin:0}
  .letter-title{font-size:24px;font-weight:900}
  .letter-body{font-size:14px;line-height:1.6}
  .letter-body p{margin:10px 0}
  .yes-btn{font-size:16px;margin-top:20px;padding:13px 45px}
  .bird-formation{width:480px;height:480px;gap:12px;flex-shrink:0;margin:0 auto;flex-basis:auto}
  .bird-item{width:150px;height:150px}
}

  /* On-screen audio status message shown when playback fails */
  .audio-status{margin-top:14px;padding:8px 12px;border-radius:8px;background:rgba(255,230,230,0.98);color:#6b2330;font-weight:700;border:1px solid #ff8a9a;font-size:14px;text-align:center;max-width:90%;box-shadow:0 6px 18px rgba(214,51,108,0.06)}
  .yes-btn.error{box-shadow:0 0 0 6px rgba(255,90,110,0.12);outline:2px solid rgba(255,90,110,0.06)}
